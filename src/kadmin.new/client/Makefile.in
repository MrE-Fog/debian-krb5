CFLAGS = $(CCOPTS) $(DEFS) $(LOCALINCLUDE) $(OVSEC_INC)
OVSEC_INC=-I/afs/dev.mit.edu/reference/ovsecure/sunos/stage/include
OVSEC_LIB=-L/afs/dev.mit.edu/reference/ovsecure/sunos/stage/lib -lclient -lcommon -lrpclib -ldyn
LDFLAGS = -g
LIBOBJS=@LIBOBJS@
ISODELIB=@ISODELIB@
COMERRLIB=$(BUILDTOP)/util/et/libcom_err.a
SSLIB=$(BUILDTOP)/util/ss/libss.a
DBMLIB=
KDBLIB=$(TOPLIBD)/libkdb5.a 

all::

KLIB = $(TOPLIBD)/libgssapi_krb5.a $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(ISODELIB) $(SSLIB) $(COMERRLIB) $(DBMLIB)
DEPKLIB = $(TOPLIBD)/libgssapi_krb5.a $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(SSLIB) $(COMERRLIB) $(DBMLIB)

SRCS =

OBJS = kadmin.o kadmin_ct.o ss_wrapper.o getdate.o $(LIBOBJS)

all:: kadmin

getdate.c getdate.h: getdate.y
	$(RM) getdate.c getdate.h y.tab.*
	$(YACC) -d $(srcdir)/getdate.y
	$(MV) y.tab.c getdate.c
	$(MV) y.tab.h getdate.h

kadmin: $(OBJS)
	$(CC) -o kadmin $(CFLAGS) $(OBJS) $(OVSEC_LIB) $(KLIB) $(LIBS)

# needed until we run makedepend
kadmin_ct.c: kadmin_ct.ct

kadmin_ct.o: kadmin_ct.c

clean::
	$(RM) kadmin $(OBJS) kadmin_ct.c getdate.c getdate.h y.tab.c y.tab.h

