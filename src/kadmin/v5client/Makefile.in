CFLAGS = $(CCOPTS) $(DEFS) $(LOCALINCLUDE)
LDFLAGS = -g

COMERRLIB=$(BUILDTOP)/util/et/libcom_err.a
SSLIB=$(BUILDTOP)/util/ss/libss.a
DBMLIB=
KDBLIB=$(TOPLIBD)/libkdb5.a 
DEPKDBLIB=$(TOPLIBD)/libkdb5.a 
KADMLIB=$(TOPLIBD)/libkadm.a
DEPKADMLIB=$(TOPLIBD)/libkadm.a

all::

KLIB = $(TOPLIBD)/libkrb5.a $(KRB4_LIB) $(TOPLIBD)/libcrypto.a $(SSLIB) $(COMERRLIB) $(DBMLIB)
DEPKLIB = $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(SSLIB) $(COMERRLIB) $(DBMLIB)


DEPLIBS = $(DEPKDBLIB) $(DEPKLIB) $(DEPKADMLIB)
LOCAL_LIBRARIES = $(KDBLIB) $(KADMLIB) $(KLIB)
LOCALINCLUDE=

OBJS= kadmin5.o \
	kadmin5_ct.o \
	network.o \
	convert.o \
	ss_wrapper.o \
	$(LIBOBJS)

SRCS= $(srcdir)/kadmin5.c \
	$(srcdir)/kadmin5_ct.c \
	$(srcdir)/ss_wrapper.c

all:: kadmin5

kadmin5: kadmin5.o $(DEPLIBS) $(OBJS)
	$(CC) $(CFLAGS) -o kadmin5 $(OBJS) $(LOCAL_LIBRARIES) $(LIBS)

install::
	$(INSTALL_PROGRAM) kadmin5 ${DESTDIR}$(ADMIN_BINDIR)/kadmin5
	$(INSTALL_DATA) $(srcdir)/kadmin5.M ${DESTDIR}$(ADMIN_MANDIR)/kadmin5.8

# needed until we run makedepend
kadmin5_ct.c: kadmin5_ct.ct

kadmin5_ct.o: kadmin5_ct.c

clean::
	$(RM) kadmin5_ct.c

depend:: kadmin5_ct.c

clean::
	$(RM) kadmin5
