TCLINC=@TCL_INC@
TCLLIB=@TCL_LIB@ -lm

CFLAGS = $(CCOPTS) $(DEFS) $(LOCALINCLUDE) $(TCLINC)

SRCS	=	tcl_ovsec_kadm.c tcl_kadm5.c test.c
OBJS	=	tcl_ovsec_kadm.o tcl_kadm5.o test.o

CLNTPROG=	ovsec_kadm_clnt_tcl
SRVPROG	=	ovsec_kadm_srv_tcl

DO_ALL=@DO_ALL@

all:: all-$(DO_ALL)

all-::
	@echo "Tcl is not installed on this system. The kadm5 test suite cannot be run."

all-tcl:: $(CLNTPROG) $(SRVPROG)

$(SRVPROG): $(OBJS) $(SRVDEPLIBS)
	$(LD) $(LDFLAGS) $(LDARGS) -o $(SRVPROG) $(OBJS) $(SRVLIBS) $(TCLLIB)

$(CLNTPROG): $(OBJS) $(CLNTDEPLIBS)
	$(LD) $(LDFLAGS) $(LDARGS) -o $(CLNTPROG) $(OBJS) $(CLNTLIBS) $(TCLLIB)

bsddb_dump: bsddb_dump.o
	$(LD) $(LDFLAGS) $(LDARGS) -o bsddb_dump bsddb_dump.o $(SRVLIBS)

clean:: 
	$(RM) $(CLNTPROG) $(SRVPROG)
