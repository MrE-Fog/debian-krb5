KRB4_LIB = @KRB4_LIB@
CFLAGS = $(CCOPTS) $(DEFS) $(LOCALINCLUDE)
LDFLAGS = -g

COMERRLIB=$(BUILDTOP)/util/et/libcom_err.a
DBMLIB=
KDBLIB=$(TOPLIBD)/libkdb5.a
DEPKDBLIB=$(TOPLIBD)/libkdb5.a

KLIB = $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(COMERRLIB) $(DBMLIB)
DEPKLIB = $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(COMERRLIB) $(DBMLIB)

DEPLIBS = $(DEPKDBLIB) $(DEPKLIB)

LOCALINCLUDE=-I$(SRCTOP)/include/kerberosIV -I$(BUILDTOP)/include/kerberosIV -I.

SRCS = \
	$(srcdir)/kadm_server.c \
	$(srcdir)/kadm_funcs.c \
	$(srcdir)/admin_server.c \
	$(srcdir)/kadm_ser_wrap.c \
	$(srcdir)/kadm_stream.c \
	$(srcdir)/kadm_supp.c \
	$(srcdir)/kadm_err.c \
	$(srcdir)/acl_files.c
OBJS = \
	kadm_server.o \
	kadm_funcs.o \
	admin_server.o \
	kadm_ser_wrap.o \
	kadm_stream.o \
	kadm_supp.o \
	kadm_err.o \
	acl_files.o

all:: kadm_err.h v4kadmind

depend:: kadm_err.c

kadm_err.c: kadm_err.et

kadm_err.h: kadm_err.et

v4kadmind: $(OBJS) $(DEPLIBS)
	$(CC) $(CFLAGS) -o v4kadmind $(OBJS) $(KDBLIB) $(KRB4_LIB) $(KLIB) $(LIBS)

install::
	$(INSTALL_PROGRAM) v4kadmind ${DESTDIR}$(SERVER_BINDIR)/v4kadmind

clean::
	$(RM) kadm_err.h kadm_err.c

clean::
	$(RM) v4kadmind

