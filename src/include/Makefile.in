##DOSBUILDTOP = ..
##DOS!include $(BUILDTOP)\config\windows.in

all:: all-$(WHAT)

all-unix::
all-mac::

all-windows::
	copy $(BUILDTOP)\util\et\com_err.h .
	copy $(BUILDTOP)\util\profile\profile.h .
	if not exist gssapi\nul mkdir gssapi
	copy $(BUILDTOP)\lib\gssapi\generic\gssapi.h gssapi
	copy $(BUILDTOP)\lib\gssapi\generic\gssapi_generic.h gssapi
	cd krb5
	@echo Making in include\krb5
	-$(MAKE) -$(MFLAGS) LIBCMD=$(LIBCMD)
	cd ..

clean:: clean-$(WHAT)

clean-unix::
clean-mac::

clean-windows::
	$(RM) com_err.h
	$(RM) gssapi\gssapi.h gssapi\gssapi_generic.h
	if exist gssapi\nul rmdir gssapi
	cd krb5
	@echo Making clean in include\krb5
	-$(MAKE) -$(MFLAGS) clean
	cd ..
	@echo Making clean locally

KRB5_HEADERS = krb5.h k5-int.h
install:: $(KRB5_HEADERS)
	@set -x; for f in $(KRB5_HEADERS) ; \
	do if cmp -s $$f $(DESTDIR)$(KRB5_INCDIR)/$$f; \
	then true; else \
		$(RM) $(DESTDIR)$(KRB5_INCDIR)/$$f; \
		cp $(srcdir)/$$f $(DESTDIR)$(KRB5_INCDIR)/$$f ; \
	fi; done
