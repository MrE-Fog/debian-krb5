#
# Makefile for building a standalone send-pr.
#
RELEASE=1.0
SUBMITTER=net
sendprname = krb5-send-pr
EMACS=emacs

infodir = $(prefix)/info
lispdir = $(prefix)/lib/emacs/site-lisp
man1dir = $(KRB5MANROOT)/man1
datadir = @datadir@

all:: send-pr  install-sid

send-pr: send-pr.sh
	sed -e 's,@DATADIR@,$(datadir),g' \
	    -e 's,@SUBMITTER@,$(SUBMITTER),g' \
	    -e 's/@DEFAULT_RELEASE@/$(RELEASE)/g' $(srcdir)/send-pr.sh > send-pr



install-sid: install-sid.sh
	sed -e 's,@ADMIN_BINDIR@,$(ADMIN_BINDIR),g' $(srcdir)/install-sid.sh > install-sid

install:: all
	if [ -d $(prefix) ]; then true ; else mkdir $(prefix) ; fi
	if [ -d $(ADMIN_BINDIR) ]; then true ; else mkdir $(ADMIN_BINDIR) ; fi
	cp send-pr $(ADMIN_BINDIR)/$(sendprname)
	chmod 755 $(ADMIN_BINDIR)/$(sendprname)
	if [ -d $(datadir) ] ; then true ; else mkdir $(datadir) ; fi
	if [ -d $(datadir)/gnats ] ; then true ; else mkdir $(datadir)/gnats ; fi
	cp $(srcdir)/categories $(datadir)/gnats/mit
	chmod 644 $(datadir)/gnats/mit
	-parent=`echo $(man1dir)|sed -e 's@/[^/]*$$@@'`; \
	if [ -d $$parent ] ; then true ; else mkdir $$parent ; fi
	if [ -d $(man1dir) ] ; then true ; else mkdir $(man1dir) ; fi
	cp $(srcdir)/send-pr.1 $(man1dir)/$(sendprname).1
	chmod 644 $(man1dir)/$(sendprname).1

clean::
	rm -f install-sid send-pr send-pr.el*

