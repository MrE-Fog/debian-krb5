#!/bin/sh
#
# makeshlib: Make a shared library.....
#
# Usage: makeshlib <host> <CC> <library> <libdirfl> <liblist> <flags>	\
#	<directories>
#

host=$1 ; shift
CC=$1 ; shift
library=$1 ; shift
libdirfl=$1; shift
liblist=$1; shift
ldflags=$1; shift

case $host in
*-*-solaris*)
	FILES=`for i 
	do
		sed -e "s;^;$i/shared/;" -e "s; ; $i/shared/;g" $i/DONE
	done`

	echo $CC -G $ldflags -o $library $FILES $libdirfl $liblist
	$CC -G $ldflags -o $library $FILES $libdirfl $liblist
	stat=$?
	;;
alpha-*-osf*)
	FILES=`for i 
	do
		sed -e "s;^;$i/;" -e "s; ; $i/;g" $i/DONE

	done`

	echo 	ld -shared -error_unresolved $ldflags -o $library -all $FILES $libdirfl $liblist -none -lc -update_registry ../../so_locations
	ld -shared -error_unresolved $ldflags -o $library -all $FILES $libdirfl $liblist -none -lc -update_registry ../../so_locations
	stat=$?
	;;

*)
	echo "Host type $host not supported!"
	exit 1
esac
exit $stat

