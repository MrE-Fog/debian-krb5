BUILDTOP=@BUILDTOP@
srcdir = @srcdir@
VPATH = @srcdir@

DEFS = @DEFS@
CC = @CC@
CCOPTS = @CCOPTS@
LIBS = @LIBS@
KRB5ROOT= @KRB5ROOT@

CFLAGS = $(CCOPTS)
LDFLAGS = -g

KRB5MANROOT = $(KRB5ROOT)/man
ADMIN_BINDIR = $(KRB5ROOT)/admin
SERVER_BINDIR = $(KRB5ROOT)/sbin
CLIENT_BINDIR = $(KRB5ROOT)/bin
ADMIN_MANDIR = $(KRB5MANROOT)/man8
SERVER_MANDIR = $(KRB5MANROOT)/man8
CLIENT_MANDIR = $(KRB5MANROOT)/man1
FILE_MANDIR = $(KRB5MANROOT)/man5
KRB5_LIBDIR = $(KRB5ROOT)/lib
KRB5_INCDIR = $(KRB5ROOT)/include
KRB5_INCSUBDIRS = \
	$(KRB5_INCDIR)/krb5 \
	$(KRB5_INCDIR)/asn.1 \
	$(KRB5_INCDIR)/kerberosIV

prefix = /usr/local
exec_prefix = $(prefix)
binprefix =
manprefix =

bindir = $(exec_prefix)/bin
libdir = $(exec_prefix)/lib
mandir = $(prefix)/man/man1
manext = 1

SHELL = /bin/sh

SRCS =  

DISTFILES = $(SRCS) $(HDRS) COPYING COPYING.LIB ChangeLog Makefile.in


all::

world::
	date
	make ${MFLAGS} mastermakefiles
	make ${MFLAGS} depend
	make ${MFLAGS} all
	date

SUBDIRS = @SUBDIRS@

INSTALLMKDIRS = $(KRB5ROOT) $(KRB5MANROOT) $(KRB5OTHERMKDIRS) \
		$(ADMIN_BINDIR) $(SERVER_BINDIR) $(CLIENT_BINDIR) \
		$(ADMIN_MANDIR) $(SERVER_MANDIR) $(CLIENT_MANDIR) \
		$(FILE_MANDIR) $(KRB5_LIBDIR) $(KRB5_INCDIR) \
		$(KRB5_INCSUBDIRS)

install:: install-mkdirs

depend:: includes


install-mkdirs:
	-mkdir $(INSTALLMKDIRS)

# install::
#	$(MAKE) $(MFLAGS) install.man

# rebuild the Makefiles in the master source tree
mastermakefiles::
	-$(MV) Makefile Makefile.bak
	$(MAKE) -f Makefile.bak Makefile
	$(MAKE) Makefiles

.c.o:
	$(CC) -c $(CPPFLAGS) $(DEFS) -I$(srcdir) $(CFLAGS) $<

check:
	@echo No tests are supplied.


TAGS: $(SRCS)
	etags $(SRCS)

clean::
	rm -f  *.o core

mostlyclean: clean

distclean: clean
	rm -f Makefile config.status

realclean: distclean
	rm -f TAGS

dist: $(DISTFILES)
	echo cpio-`sed -e '/version_string/!d' \
	-e 's/[^0-9.]*\([0-9.]*\).*/\1/' -e q version.c` > .fname
	rm -rf `cat .fname`
	mkdir `cat .fname`
	-ln $(DISTFILES) `cat .fname`
	for file in $(DISTFILES); do \
	  test -r `cat .fname`/$$file || cp -p $$file `cat .fname`; \
	done
	tar chzf `cat .fname`.tar.gz `cat .fname`
	rm -rf `cat .fname` .fname
