#	$Source$
#	$Author$
#	$Id$
#
#  Copyright 1992 by the Massachusetts Institute of Technology.
#  All Rights Reserved.
# 
# Export of this software from the United States of America may
#   require a specific license from the United States Government.
#   It is the responsibility of any person or organization contemplating
#   export to obtain such a license before exporting.
# 
# WITHIN THAT CONSTRAINT, permission to use, copy, modify, and
# distribute this software and its documentation for any purpose and
# without fee is hereby granted, provided that the above copyright
# notice appear in all copies and that both that copyright notice and
# this permission notice appear in supporting documentation, and that
# the name of M.I.T. not be used in advertising or publicity pertaining
# to distribution of the software without specific, written prior
# permission.  M.I.T. makes no representations about the suitability of
# this software for any purpose.  It is provided "as is" without express
# or implied warranty.
# 
# 
DEPLIBS = $(DEPKDBLIB) $(DEPKLIB)
LOCAL_LIBRARIES = $(KDBLIB) $(KLIB)

CTOBJS = kdb5_ed_ct.o
CTSRCS = kdb5_ed_ct.c

#if HasTcl
MOSTOBJS = kdb5_edit.o util.o dump.o
MOSTSRCS = kdb5_edit.c util.c dump.c
TCLOBJS = tcl_wrapper.o
TCLSRCS = tcl_wrapper.c
SSOBJS = ss_wrapper.o $(CTOBJS)
SSSRCS = ss_wrapper.c $(CTSRCS)
OBJS = $(MOSTOBJS) $(TCLOBJS) $(SSOBJS)
SRCS = $(MOSTSRCS) $(TCLSRCS) $(SSSRCS)
#else
OBJS = kdb5_edit.o util.o dump.o $(CTOBJS) ss_wrapper.o
SRCS = kdb5_edit.c util.c dump.c $(CTSRCS) ss_wrapper.c
#endif

#if HasTcl
all:: kdb5_edit.ss kdb5_edit.tcl
#else
all:: kdb5_edit
#endif

CmdTableObjectRule()

# needed until we run makedepend
kdb5_ed_ct.o: kdb5_ed_ct.c

clean::
	$(RM) kdb5_ed_ct.c

#if HasTcl
INCLUDES = $(TCLINCLUDES)
NormalProgramTarget(kdb5_edit.ss,$(MOSTOBJS) $(SSOBJS),$(DEPLIBS),$(LOCAL_LIBRARIES) $(SSLIB),)
NormalProgramTarget(kdb5_edit.tcl,$(MOSTOBJS) $(TCLOBJS),$(DEPLIBS),$(LOCAL_LIBRARIES) $(TCLLIBS),)
#else
NormalProgramTarget(kdb5_edit,$(OBJS),$(DEPLIBS),$(LOCAL_LIBRARIES) $(SSLIB),)
#endif

Krb5InstallAdminProgram(kdb5_edit)

#if HasTcl
SaberProgramTarget(kdb5_edit.ss,$(MOSTSRCS) $(CTSRCS),$(OBJS),$(LOCAL_LIBRARIES),)
SaberProgramTarget(kdb5_edit.tcl,$(MOSTSRCS) $(TCLSRCS),$(OBJS),$(LOCAL_LIBRARIES),)
#else
SaberProgramTarget(kdb5_edit,$(SRCS),$(OBJS),$(LOCAL_LIBRARIES),)
#endif

depend:: kdb5_ed_ct.c

DependTarget()
