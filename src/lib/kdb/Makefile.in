BUILDTOP=@BUILDTOP@
RANLIB = @RANLIB@
ARCHIVE = @ARCHIVE@
ARADD = @ARADD@

srcdir = @srcdir@
VPATH = @srcdir@

DEFS = @DEFS@
CC = @CC@
CCOPTS = @CCOPTS@
LIBS = @LIBS@
KRB5ROOT = @KRB5ROOT@
 
KRB5MANROOT = $(KRB5ROOT)/man
ADMIN_BINDIR = $(KRB5ROOT)/admin
SERVER_BINDIR = $(KRB5ROOT)/sbin
CLIENT_BINDIR = $(KRB5ROOT)/bin
ADMIN_MANDIR = $(KRB5MANROOT)/man8
SERVER_MANDIR = $(KRB5MANROOT)/man8
CLIENT_MANDIR = $(KRB5MANROOT)/man1
FILE_MANDIR = $(KRB5MANROOT)/man5
KRB5_LIBDIR = $(KRB5ROOT)/lib
KRB5_INCDIR = $(KRB5ROOT)/include
KRB5_INCSUBDIRS = \
	$(KRB5_INCDIR)/krb5 \
	$(KRB5_INCDIR)/asn.1 \
	$(KRB5_INCDIR)/kerberosIV

CFLAGS = $(CCOPTS) $(DEFS)
LDFLAGS = -g

RM = rm -f
CP = cp

SRCTOP = $(srcdir)/$(BUILDTOP)

all:: $(OBJS)


SRCS= \
	$(srcdir)/encrypt_key.c \
	$(srcdir)/decrypt_key.c \
	$(srcdir)/kdb_dbm.c \
	$(srcdir)/verify_mky.c \
	$(srcdir)/fetch_mkey.c \
	$(srcdir)/setup_mkey.c \
	$(srcdir)/store_mkey.c

OBJS= \
	encrypt_key.o \
	decrypt_key.o \
	kdb_dbm.o \
	verify_mky.o \
	fetch_mkey.o \
	setup_mkey.o \
	store_mkey.o

TOPLIBD = $(BUILDTOP)/lib

libkdb5.a: $(OBJS)
	$(RM) $@
	$(ARADD) $@ $(OBJS)
	$(RANLIB) $@
	$(RM) $(TOPLIBD)/libkdb5.a
	$(CP) libkdb5.a $(BUILDTOP)/lib/libkdb5.a
	$(RANLIB) $(BUILDTOP)/lib/libkdb5.a

install:: libkdb5.a
	$(RM) $(KRB5_LIBDIR)/libkdb5.a
	$(CP) libkdb5.a $(KRB5_LIBDIR)/libkdb5.a
	$(RANLIB) $(KRB5_LIBDIR)/libkdb5.a

clean::
	$(RM) $(OBJS)

clean::
	$(RM) libkdb5.a
