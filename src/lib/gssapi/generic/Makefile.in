BUILDTOP=@BUILDTOP@
SUBDIRS = @SUBDIRS@

srcdir = @srcdir@
VPATH = @srcdir@

DEFS = @DEFS@
CCOPTS = @CCOPTS@
LIBS = @LIBS@
 
CFLAGS = $(CCOPTS) $(DEFS) -I. -I$(srcdir)
LDFLAGS = -g

RM = rm -f
CP = cp

AWK = @AWK@

SRCTOP = $(srcdir)/$(BUILDTOP)

all:: $(OBJS)

ETSRCS= gssapi_generic_err.c
ETOBJS= gssapi_generic_err.o
ETHDRS= gssapi_generic_err.h

gssapi_generic_err.o: gssapi_generic_err.c

gssapi_generic_err.h: gssapi_generic_err.et

gssapi_generic_err.c: gssapi_generic_err.et

#if HasHashLibrary
# UTIL_VALIDATE_SRC= $(srcdir)/util_validate.c
# UTIL_VALIDATE_OBJ= util_validate.o
#else
UTIL_VALIDATE_SRC= $(srcdir)/util_val_nohash.c
UTIL_VALIDATE_OBJ= util_val_nohash.o
#endif

CCSRCS = \
	$(srcdir)/display_major_status.c \
	$(srcdir)/display_com_err_status.c \
	$(srcdir)/gssapi_generic.c \
	$(srcdir)/release_buffer.c \
	$(srcdir)/release_oid_set.c \
	$(srcdir)/util_buffer.c \
	$(srcdir)/util_canonhost.c \
	$(srcdir)/util_dup.c \
	$(srcdir)/util_oid.c \
	$(srcdir)/util_token.c \
	$(UTIL_VALIDATE_SRC)

CCOBJS = \
	display_major_status.o \
	display_com_err_status.o \
	gssapi_generic.o \
	release_buffer.o \
	release_oid_set.o \
	util_buffer.o \
	util_canonhost.o \
	util_dup.o \
	util_oid.o \
	util_token.o \
	$(UTIL_VALIDATE_OBJ)


EHDRDIR= $(BUILDTOP)/include/gssapi
EXPORTED_HEADERS= gssapi.h gssapi_generic.h

SRCS= $(ETSRCS) $(CCSRCS)
OBJS= $(ETOBJS) $(CCOBJS)
HDRS= $(ETHDRS)

all:: $(SRCS) $(HDRS) includes $(OBJS)

clean::
	$(RM) $(ETHDRS) $(ETSRCS)

# Krb5InstallHeaders($(EXPORTED_HEADERS), $(KRB5_INCDIR)/krb5)

includes::
	@-mkdir $(EHDRDIR)

depend:: $(ETSRCS)

