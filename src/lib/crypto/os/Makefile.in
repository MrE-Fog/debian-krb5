CFLAGS = $(CCOPTS) $(DEFS)

##DOSBUILDTOP = ..\..\..
##DOSLIBNAME=..\crypto.lib
##DOS!include $(BUILDTOP)\config\windows.in

LIBOBJS = @LIBOBJS@

.c.o:
	$(CC) $(CFLAGS) -c $(srcdir)/$*.c
@SHARED_RULE@

OBJS=	rnd_confoun.$(OBJEXT) localaddr.$(OBJEXT) ustime.$(OBJEXT) $(LIBOBJS)

SRCS=	rnd_confoun.c

all:: all-$(WHAT)

all-unix:: shared $(OBJS)

all-mac:: $(OBJS)

all-windows: rnd_confoun.obj

shared:
	mkdir shared
	

localaddr.c: $(SRCTOP)$(S)lib$(S)krb5$(S)os$(S)localaddr.c
	-$(LN) $(SRCTOP)$(S)lib$(S)krb5$(S)os$(S)localaddr.c $@

ustime.c: $(SRCTOP)$(S)lib$(S)krb5$(S)os$(S)ustime.c
	-$(LN) $(SRCTOP)$(S)lib$(S)krb5$(S)os$(S)ustime.c $@

memmove.c: $(SRCTOP)$(S)lib$(S)krb5$(S)posix$(S)memmove.c
	-$(LN) $(SRCTOP)$(S)lib$(S)krb5$(S)posix$(S)memmove.c $@

localaddr.o: localaddr.c
	$(CC) $(CFLAGS) -c $*.c
@SHARED_RULE_LOCAL@
	
ustime.o: ustime.c
	$(CC) $(CFLAGS) -c $*.c
@SHARED_RULE_LOCAL@
	
memmove.o: memmove.c
	$(CC) $(CFLAGS) -c $*.c
@SHARED_RULE_LOCAL@
	

clean:: clean-$(WHAT)
	$(RM) ustime.c localaddr.c memmove.c

clean-unix::
	$(RM) shared/*
clean-mac::
	$(RM) shared/*
clean-windows::
