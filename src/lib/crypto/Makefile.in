BUILDTOP=@BUILDTOP@
srcdir = @srcdir@
VPATH = @srcdir@

ARCHIVE = @ARCHIVE@
ARADD = @ARADD@

SUBDIRS = @SUBDIRS@

DEFS = @DEFS@
CC = @CC@
CCOPTS = @CCOPTS@
LIBS = @LIBS@
 
CFLAGS = $(CCOPTS) $(DEFS)
LDFLAGS = -g

RM = rm -f
CP = cp
RANLIB = @RANLIB@

TST=if test -n "`cat DONE`" ; then

SRCTOP = $(srcdir)/$(BUILDTOP)

OBJS=	cryptoconf.o
SRCS=	$(srcdir)/cryptoconf.c

all::

libcrypto.a: des/DONE md4/DONE md5/DONE crc32/DONE os/DONE $(OBJS)
	(cd des; $(TST) $(ARADD) ../$@ `cat DONE` ; fi)
	(cd crc32; $(TST) $(ARADD) ../$@ `cat DONE` ; fi)
	(cd md4; $(TST) $(ARADD) ../$@ `cat DONE` ; fi)
	(cd md5; $(TST) $(ARADD) ../$@ `cat DONE` ; fi)
	(cd os; $(TST) $(ARADD) ../$@ `cat DONE` ; fi)
	$(ARADD) $@ $(OBJS)
	$(RANLIB) $@

install:: libcrypto.a
	$(RM) $(KRB5_LIBDIR)/lib/libcrypto.a
	$(CP) libcrypto.a $(KRB5_LIBDIR)/lib/libcrypto.a
	$(RANLIB) $(KRB5_LIBDIR)/lib/libcrypto.a
