CFLAGS = $(CCOPTS) $(DEFS)
LDFLAGS = -g

all:: $(OBJS)

OBJS=	cksum.o		\
	des.o		\
	enc_dec.o	\
	key_parity.o	\
	key_sched.o	\
	new_rnd_key.o	\
	pcbc_encrypt.o	\
	quad_cksum.o	\
	random_key.o	\
	read_passwd.o \
	str_to_key.o	\
	weak_key.o	

SRCS=	$(srcdir)/cksum.c	\
	$(srcdir)/des.c		\
	$(srcdir)/enc_dec.c	\
	$(srcdir)/key_parity.c	\
	$(srcdir)/key_sched.c	\
	$(srcdir)/new_rnd_key.c	\
	$(srcdir)/pcbc_encrypt.c	\
	$(srcdir)/quad_cksum.c	\
	$(srcdir)/random_key.c	\
	$(srcdir)/read_passwd.c \
	$(srcdir)/str_to_key.c \
	$(srcdir)/weak_key.c	


EXT_LIB= libdes425.a $(TOPLIBD)/libcrypto.a
DEPKLIB= $(TOPLIBD)/libcrypto.a

verify: verify.o libdes425.a $(DEPKLIB)
	$(CC) -o $@ verify.o $(LDFLAGS) $(EXT_LIB)

check:: verify
	./verify -z
	./verify -m
	./verify

clean::
	$(RM) verify

libdes425.a: $(OBJS)
	$(RM) $@
	$(ARADD) $@ $(OBJS)
	$(RANLIB) $@
	$(RM) $(TOPLIBD)/libdes425.a
	$(CP) libdes425.a $(BUILDTOP)/lib/libdes425.a
	$(RANLIB) $(BUILDTOP)/lib/libdes425.a

install:: libdes425.a
	$(INSTALL_DATA) libdes425.a $(DESTDIR)$(KRB5_LIBDIR)/libdes425.a
	$(RANLIB) $(DESTDIR)$(KRB5_LIBDIR)/libdes425.a

clean::
	$(RM) libdes425.a

