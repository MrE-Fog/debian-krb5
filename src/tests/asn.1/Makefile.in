CFLAGS = $(CCOPTS) $(DEFS) $(LOCALINCLUDES)
LDFLAGS = -g

ISODELIB=@ISODELIB@
COMERRLIB=$(BUILDTOP)/util/et/libcom_err.a
DBMLIB=

all:: krb5_encode_test krb5_decode_test

KLIB = $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(ISODELIB) $(COMERRLIB) $(DBMLIB)
DEPKLIB = $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(COMERRLIB) $(DBMLIB)

LOCALINCLUDES = -I$(srcdir)/../../lib/krb5/asn.1

ENCOBJS = krb5_encode_test.o ktest.o ktest_equal.o utility.o trval.o

krb5_encode_test: $(ENCOBJS) $(DEPKLIB) 
	$(LD) $(CFLAGS) -o krb5_encode_test $(ENCOBJS) $(LIBS) $(KLIB)

DECOBJS = krb5_decode_test.o ktest.o ktest_equal.o utility.o

krb5_decode_test: $(DECOBJS) $(DEPKLIB)
	$(LD) $(CFLAGS) -o krb5_decode_test $(DECOBJS) $(LIBS) $(KLIB)

check:: krb5_decode_test krb5_encode_test
	./krb5_decode_test
	$(RM) test.out
	./krb5_encode_test > test.out
	cmp test.out $(srcdir)/reference_encode.out
	./krb5_encode_test -t > test.out
	cmp test.out $(srcdir)/trval_reference.out
	$(RM) test.out	

install::

clean::
	rm -f *~ *.o krb5_encode_test krb5_decode_test test.out


################ Dependencies ################
krb5_decode_test.o: ktest.h utility.h ktest_equal.h debug.h
krb5_encode_test.o: utility.h ktest.h debug.h
ktest.o: ktest.h utility.h
ktest_equal.o: ktest_equal.h
#utility.o: utility.h
#utility.h: krbasn1.h asn1buf.h
##############################################

