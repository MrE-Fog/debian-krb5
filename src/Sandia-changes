# This file containes the changes made to the kerberos code
# for porting to various platforms:

Date	 System	    File		  Changes
10/?/91  all	    cr_auth_rply.c	  Added files to lib/krb425 so
	 	    cr_err_reply.c	  that the kdc could handle v4
	 	    cr_ticket.c	          AS and TGS requests.
		    create_ciph.c
		    month_sname.c
		    log.c
		    one.c
		    stime.c

10/2/91	 hpux9000   com_err/compile_et.c  Added hpux to i386 to include 
					  strcasecmp routine which is not
					  in the hpux stdc library.

10/2/91  hpux9000   com_err/et_lex.lex.l  Added hpux ifdef to use strrchr 
					  instead of rindex.

10/2/91  hpux9000   ss/cmd_tbl.l	  Added hpux ifdef to use strrchr
                                          instead of rindex.

10/2/91  hpux9000   ss/ss_internal.h	  Added hpux ifdef to use strrchr
                                          instead of rindex, strchr instead of
					  index, and memcpy of bcopy.

10/7/91  hpux9000   ss/listen.c		  ifndef hpux to  "not" declare index().

10/2/91	  hpux9000  ss/mk_cmds.c	  Changed mk_cmds to use "ss.h" instead
					  of <ss.h> i.e.
				  fputs("#include <ss.h>\n\n", output_file); =>
				  fputs("#include \"ss.h\"\n\n", output_file);

10/3/91   hpux9000  include/fake-stdlib.h ifndef hpux on declaration of strlen
		    usr2/krb5/isode-interim/include

10/3/91   hpux9000  lib/os/gen_rname.c    ifndef hpux on include of
		    kdc/do_as_req.c 	  <arpa/inet.h>
		    kdc/do_tgs_req.c 
		    kdc/kerberos_v4.c 
		    kdc/network.c 
		    slave/kpropd.c
		    appl/popper/pop_init.c 
		    appl/user-user/client.c 
		    appl/user-user/server.c
		    lib/krb425/mk_priv.c
		    lib/krb425/rd_priv.c
		    lib/krb425/mk_safe.c
		    lib/krb425/rd_safe.c

	-- Where is the declaration of inet_ntoa() and related functions
	   on HPUX?  --

10/4/91	  hpux9000  include/krb5/stock/config.h  Added ifdef SYSV which 
						 redefines random,srandom,
						 and utimes to rand,srand,
						 and utime

	-- Are these functions sufficiently compatible?  The changes
	   should be in osconf.h, not config.h (or maybe somewhere else). --

10/4/91   hpux9000  lib/des425/des.h	Added #include <krb5/asn1.h> to 
					get bzero() and bcopy() defines.

	-- Wrong fix.  --

10/7/91   hpux9000  lib/os/strcasecmp.c Added routines strncasecmp() and
					strcasecmp() into new file strcasecmp.c.
					These routines are included if the
					the variable NEED_STRCASECMP is defined.
					For hpux this is defined into the
					variable StandardDefines in 
					site.def.hp9000.  The Imakefile file for
					lib/os was also updated to build
					strcasecmp.c

	-- Maybe.  Should we instead fix the library not to use
	   strcasecmp()?  The only use appears to be in os/hst_realm.c.  */

10/7/91   hpux9000  appl/movemail.c	Added #ifdef SYSV => to undefine
					MAIL_USE_FLOCK since real system v uses
					lockf or POSIX style file locks. Also
					included <krb5/asn1.h> so that bcmp and
					rindex are defined to something 
					available on this platform.

	-- Do SYSV systems want to avoid locking files, or do they want to
	   use lockf/fcntl to lock files?  <krb5/asn1.h> is the wrong file
	   to include. --

10/7/91   hpux9000  appl/popper/popper.h  Ifdef SANDIA to include asn1.h to
					  define a system dependant bzero and 
					  index. Also defined a file_lock to 
					  replace the system dependent flock().

		    appl/popper/pop_updt.c  Use file_lock defined in popper.h
		    appl/popper/pop_dropcopy.c

	-- Does lockf() work on POSIX, or do you need to use fcntl directly?
	   Including asn1.h is wrong.  */


10/7/91   hpux9000  slave/kprop.c	  Ifdef SANDIA to use file locking
				          routines in lib/os/lock_file.c, which
					  takes into account POSIX file locking
					  and does not blanketly use flock().

	-- Already fixed in MIT source. --

10/7/91   hpux9000  lib/krb425/des_sched.c  Ifndef SANDIA to remove the 
	 (BUG FIX) 			    des_key_sched() routine from this
	  really			    file. It was a noop but is necessary
					    for the kdc to handle v4 kinits. By
					    removing, the "good" des_key_sched 
					    in lib/des425/key_sched.c will now 
					    be used.

	-- Probably put off to post-beta.  --

11/12/91  All	    lib/krb/rd_req_dec.c:   BUG fix reset tktauthent->ticket to
				 	    0 after krb5_auth_to_rep call so 
					    that if cleanup is done req->ticket
				     	    is not freed up.

	-- Similar fix installed.  --

11/15/91 all        krb4_rd_req.c         Added file to lib/krb425 so
                                          kdc would not use the krb_rd_req
                                          routine in libkrb425.a. The rd_req
                                          in libkrb425.a does not handle a
                                          true version 4 mk_req.

11/15/91 all        kdc/kerberos_v4.c     Ifdef SANDIA to call krb4_rd_req
                                          instead of the rd_req in krb425.


12/4/91	  All	    lib/krb425/425data.c    	Setup the variables ky and 
		    lib/krb425/krb4_rd_req.c  	serv_key in 425data.c so that
		    lib/krb425/set_key.c        the krb_set_key routine which
						was located there could be 
						replaced with the krb_set_key
						routine in set_key.c. Set_key.c
						which is used for lib425
						krb_rd_req, uses a different
						global service key than 
						krb4_rd_req, so we added the
						setting of ky and serv_key there
						also so that the same routine
						could be used for krb4_rd_req 
						and (lib425) krb_rd_req.

	-- ? --



12/18/91  All	     lib/krb/getcredswopt.c	Added new routines 
						krb5_get_credentials_wkdcopt
						krb5_get_cred_from_kdc_wkdcopt
						krb5_get_cred_via_tgt_wkdcopt

						which allow applications to 
						implement forwarding/proxy and
						other kdc options.

	-- There is no such file in the archive.  --

12/18/91  All	     lib/krb/int-proto.h	Added calls for new routine
						krb5_get_cred_via_tgt_wkdcopt.

12/18/91  All	     lib/krb/copy_addrs.c	Added routine :
						krb5_append_addresses() which 
						allows appending addresses to a
						list of addresses. Used for
						proxy and forwarding.

	-- Modified version installed.  --

12/18/91  All	     lib/krb/copy_checksum.c  	Renamed copy_checksum.c to
						copy_cksum.c so that it would
						fit into the 14 character limit
						of the archive program ar.

	-- Should do this for beta 2. --
						
12/18/91  All	     lib/krb/Imakefile		Changed to add new name for
						copy_checksum.c and to add the
						file getcredswopt.c

12/18/91  All	     appl/sample/sserver/sserver.c   Added new checks for proxy
		     appl/sample/sclient/sclient.c   and forwarded tickets.

12/18/91  hpux	      lib/syslog.c		Ifdefed out the syslog routines
						for hpux and set vsyslog to
						simply call hpuxs syslog library
						routine.

	-- Shouldn't this change go into a config file? --

1/29/92	  ALL	      lib/krb/copy_auth.c	BUG fix : check for input 
						reference ptr == 0, if so 
						return 0. If not done suns
						core dump.

	-- Is this needed?  I've never had a NULL pointer core dump in this
	   code.  --

2/13/92	  ALL	      lib/os/an_to_ln.c		For Sandia if /etc/aname does
	(sandia only)				not exist then use the "other"
						krb5_aname_to_localname as if
						USE_DBM_LNAME was not defined.

2/18/92   ALL	       lib/krb/copy_data.c	Modified so that the structure
						assignment is not necessary. 
						Also added some null pointer,
						and zero length checks.
					
	-- Is this needed?  When will this function be called with a zero
	   length krb5_data structure?  --

3/17/92	  unicos and 	 lib/asn1/asn1glue.h 	 Changed xmalloc define so
	    sysvimp				  that if 0 len is passed 
						  at least 1 byte is malloc'd.

	-- asn.1 source is changed so that malloc is not called when
	   the size is 0, but NULL is returned unconditionally; this
	   fix is not needed.  --

4/20/92	   ALL	include/krb5/error_tables/krb5_err.h  Added error
		lib/error_tables/krb5_err.et	      KRB5KDC_ERR_KEY_EXPIRED
		include/krb5/errors.h		      to explain expired
						      passwords

	-- This is a protocol change.  Can we do it?  --

5/3/92	ALL		lib/asn.1/adat2kadat.c  Bug fix which allows passing
						of ticket authoriztion info.

	-- Simpler fix installed ("rv->next" should have been "rv"). --

5/4/92	ALL		lib/os/read_pwd.c       Added better signal catching 
						facilities. SunOS would core
						dump on SIGQUIT signals when
						in krb5_read_password().

	-- What's wrong with that?  Dumping core is standard procedure
	   for SIGQUIT.  --
