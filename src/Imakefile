#	$Source$
#	$Author$
#	$Id$
#
#  Copyright 1990,1991 by the Massachusetts Institute of Technology.
#  All Rights Reserved.
# 
#  For copying and distribution information, please see the file
#  <krb5/copyright.h>.
# 
#define IHaveSubdirs
#define PassCDebugFlags

/* default target... */
all::

#ifdef UseComErrInstalled
COMERRDIR=
world::
	$(RM) include/com_err.h
#else
COMERRDIR=comerr
world::
	$(RM) include/com_err.h
	$(LN) ../comerr/com_err.h include/com_err.h
#endif
#ifdef UseSSInstalled
SSDIR=
#else
SSDIR=ss
#endif
#ifdef UseUnifdefInstalled
UNIFDIR=
#else
UNIFDIR=util/unifdef
#endif
world::
	make ${MFLAGS} mastermakefiles
	make ${MFLAGS} depend
	make ${MFLAGS} all

SUBDIRS = $(UNIFDIR) include $(COMERRDIR) $(SSDIR) lib kdc admin clients appl
LNINSTALLDIRS = 

MakeSubdirs($(SUBDIRS))

depend:: includes

/**/# rebuild the Makefiles in the master source tree
#ifdef UseImakeInstalled
mastermakefiles::
	-$(MV) Makefile Makefile.bak
	$(MAKE) -f Makefile.bak Makefile
	$(MAKE) Makefiles
#else
mastermakefiles::
	cd $(IMAKESRC); $(MAKE) -f Makefile.ini clean; $(MAKE) -f Makefile.ini BOOTSTRAPCFLAGS="$(BOOTSTRAPCFLAGS)"
	-$(MV) Makefile Makefile.bak
	$(MAKE) -f Makefile.bak Makefile
	$(MAKE) Makefiles
#endif
